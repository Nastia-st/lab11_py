import pandas as pd

# Початковий словник із 5 роботи
countries = {
    "Україна": {"населення": 37.0, "площа": 603.7, "континент": "Європа"},
    "Польща": {"населення": 38.0, "площа": 312.7, "континент": "Європа"},
    "Франція": {"населення": 67.8, "площа": 551.7, "континент": "Європа"},
    "Німеччина": {"населення": 84.3, "площа": 357.6, "континент": "Європа"},
    "Італія": {"населення": 59.0, "площа": 301.3, "континент": "Європа"},
    "Іспанія": {"населення": 48.5, "площа": 505.9, "континент": "Європа"},
    "Швеція": {"населення": 10.5, "площа": 450.3, "континент": "Європа"},
    "Канада": {"населення": 39.0, "площа": 9984.7, "континент": "Північна Америка"},
    "Японія": {"населення": 125.1, "площа": 377.9, "континент": "Азія"},
    "Китай": {"населення": 1400.0, "площа": 9597.0, "континент": "Азія"}
}

# Перетворення словника у DataFrame 
df = pd.DataFrame.from_dict(countries, orient='index')
df.index.name = "країна"

# Додавання розрахункового стовпця
df["щільність"] = df["населення"] / df["площа"]

# Виведення повного DataFrame
print("\nПовний DataFrame:")
print(df)

# Вивід перших 3 рядків
print("\nПерші 3 рядки DataFrame:")
print(df.head(3))

# Перевірка типів даних
print("\nТипи даних у стовпцях:")
print(df.dtypes)

# Кількість рядків і стовпців
print("\nРозмірність DataFrame (рядки, стовпці):")
print(df.shape)

# Описова статистика
print("\nОписова статистика:")
print(df.describe())

# Фільтрація даних
filtered = df[df["населення"] > 100]
print("\nКраїни з населенням понад 100 млн:")
print(filtered)

# Сортування даних за спаданням щільності населення
sorted_df = df.sort_values(by="щільність", ascending=False)
print("\nСортування за спаданням щільності населення:")
print(sorted_df)

# Групування та середнє значення
group_mean = df.groupby("континент")[["населення", "площа", "щільність"]].mean()
print("\nСередні значення за континентами:")
print(group_mean)

# Додаткові операції агрегації
max_density = df.groupby("континент")["щільність"].max()
unique_countries = df.index.nunique()

print("\nМаксимальна щільність населення у кожному континенті:")
print(max_density)
print(f"\nКількість унікальних країн у таблиці: {unique_countries}")